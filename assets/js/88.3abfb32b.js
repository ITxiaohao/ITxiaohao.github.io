(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{386:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"基本命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 基本命令")]),s._v(" "),t("p",[s._v("Windows 下 Nginx 的基本命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\nstart nginx 或 nginx.exe\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止")]),s._v("\nnginx.exe -s stop 或 nginx.exe -s quit "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# stop 是快速停止 nginx，可能不会保存相关信息，quit 是有序的停止 nginx，会保存信息")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启")]),s._v("\nnginx.exe -s reload "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 替换静态资源不需要重启，只有修改 nginx config 才需要重启")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新打开日志文件")]),s._v("\nnginx.exe -s reopen\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看版本")]),s._v("\nnginx.exe -v\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"静态资源配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#静态资源配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 静态资源配置")]),s._v(" "),t("p",[s._v("这里以 Vue 项目为例")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717142614.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717142651.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717142754.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"开启跨越"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开启跨越","aria-hidden":"true"}},[s._v("#")]),s._v(" 开启跨越")]),s._v(" "),t("p",[s._v("配置前缀路径，当请求路径包含前缀的时候被 nginx 转发到 proxy_pass 里配置的后端服务地址")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717143027.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"开启-gzip-压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开启-gzip-压缩","aria-hidden":"true"}},[s._v("#")]),s._v(" 开启 Gzip 压缩")]),s._v(" "),t("p",[s._v("nginx 默认是关闭 Gzip，")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("# 开启和关闭gzip模式\ngzip on;\n# gizp 压缩起点，文件大于 1k 才进行压缩\ngzip_min_length 1k;\n# gzip 压缩级别，1-9，数字越大压缩的越好，也越占用 CPU\ngzip_comp_level 6;\n# 进行压缩的文件类型。\ngzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php application/vnd.ms-fontobject font/ttf font/opentype;\n# nginx 对于静态文件的处理模块，开启后会寻找以 .gz 结尾的文件，直接返回，不会占用cpu 进行压缩，如果找不到则进行压缩\ngzip_static on\n# 是否在 http header 中添加 Vary: Accept-Encoding，建议开启\ngzip_vary on;\n# 设置gzip压缩针对的HTTP协议版本\ngzip_http_version 1.1;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717143520.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"_405-报错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_405-报错","aria-hidden":"true"}},[s._v("#")]),s._v(" 405 报错")]),s._v(" "),t("p",[s._v("仔细看看是不是后台代理没写好，最好和 Vue 里面配置的跨域地址一样，少一个斜杠多一个斜杠都会匹配不到，例如一下这四种情况，具体怎么配置根据实际项目来：")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("location /api {\n    proxy_pass http://192.168.65.74:8888;\n}\n\nlocation /api/ {\n    proxy_pass http://192.168.65.74:8888;\n}\n\nlocation /api {\n    proxy_pass http://192.168.65.74:8888/;\n}\n\nlocation /api/ {\n    proxy_pass http://192.168.65.74:8888/;\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"无外网环境下配置域名地址会报错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#无外网环境下配置域名地址会报错","aria-hidden":"true"}},[s._v("#")]),s._v(" 无外网环境下配置域名地址会报错")]),s._v(" "),t("p",[s._v("如果 nginx.conf 文件里配置的跨域地址是域名地址，而服务器却不能访问外网，则 nginx 启动不起来，会报错")]),s._v(" "),t("h2",{attrs:{id:"上传文件超过-1m-报错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传文件超过-1m-报错","aria-hidden":"true"}},[s._v("#")]),s._v(" 上传文件超过 1M 报错")]),s._v(" "),t("p",[s._v("上传到后台的文件超过 1M 的时候，客户端文件无法正常上传")]),s._v(" "),t("p",[s._v("解决方案：")]),s._v(" "),t("p",[s._v("修改跨域到后端的配置")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("location /api {\n    proxy_pass http://192.168.65.74:8888;\n    client_max_body_size    10m; # 表示最大上传10M，需要多大设置多大\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"页面缓存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页面缓存","aria-hidden":"true"}},[s._v("#")]),s._v(" 页面缓存")]),s._v(" "),t("p",[s._v("一般缓存是针对不常发生变化的内容来做的缓存，比如图片，如果每次访问都请求加载很多图片资源的话，是非常浪费服务器资源的")]),s._v(" "),t("p",[s._v("由于浏览器缓存静态文件的时间不可控，可以在 nginx 上自己配置 expires 1M（1 个月）")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("location ~* \\.(gif|jpg|jpeg|png|css|js|ico|eot|otf|fon|font|ttf|ttwoff|woff2)$ {\n    root /vue;\n    expires 1M;\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("该配置表示：所有在 /vue 目录下的以.jpg、.png、.gif、.jpeg 为后缀 (不区分大小写) 的文件缓存 1 个月。")]),s._v(" "),t("h2",{attrs:{id:"windows-下设置成服务并开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-下设置成服务并开机启动","aria-hidden":"true"}},[s._v("#")]),s._v(" windows 下设置成服务并开机启动")]),s._v(" "),t("p",[s._v("载 Windows Service Wrapper 工具")]),s._v(" "),t("p",[s._v("https://github.com/kohsuke/winsw")]),s._v(" "),t("p",[s._v("下载这个版本的文件 WinSW.NET4.exe")]),s._v(" "),t("p",[s._v("将 Nginx 转换为 Windows 服务，这样就可以在开机时自动启动 Nginx 了")]),s._v(" "),t("p",[s._v("下载后将该工具放入 Nginx 的安装目录下，并且将其重命名为 nginx-service.exe ，在该目录下新建 nginx-service.xml 文件，写入配置信息，配置好了之后就可以通过这个将 Nginx 注册为 Windows 服务。")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- nginx-service.xml --\x3e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("description")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("description")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("logpath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("D:\\nginx-app\\nginx-1.12.2"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("logpath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("logmode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("roll"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("logmode")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("depend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("depend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("executable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("D:\\nginx-app\\nginx-1.12.2\\nginx.exe"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("executable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("stopexecutable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("D:\\nginx-app\\nginx-1.12.2\\nginx.exe -s stop"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("stopexecutable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("将上面配置的路径改为实际 nginx 路径即可")]),s._v(" "),t("p",[s._v("如果报错：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717145359.png",alt:""}})]),s._v(" "),t("p",[s._v("解决方案：")]),s._v(" "),t("p",[s._v("微软官网下载 https://www.microsoft.com/zh-CN/download/confirmation.aspx?id=48137")]),s._v(" "),t("p",[s._v("以上内容配置好了之后，在 nginx 安装目录下以管理员运行命令：.\\nginx-service.exe install 就成功将其注册为 Windows 服务了，然后运行 .\\nginx-service.exe start 启动服务。这时我们可以在 Windows 任务管理器的服务中查看该是否成功启动。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://raw.githubusercontent.com/ITxiaohao/blog-img/master/img/nginx/20190717145451.png",alt:""}})]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("nginx-service.exe "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令可注册对应的系统服务")]),s._v("\nnginx-service.exe uninstall "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令可删除对应的系统服务")]),s._v("\nnginx-service.exe stop "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令可停止对应的系统服务")]),s._v("\nnginx-service.exe start "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令可启动对应的系统服务")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])},[],!1,null,null,null);a.default=e.exports}}]);